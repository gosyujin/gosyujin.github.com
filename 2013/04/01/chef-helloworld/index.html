<!DOCTYPE html>
<html>
  <head>
    
      
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-34929069-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

    

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>
      
   入門Chef Solo - Infrastructure as Code を読みながらChef Soloで遊べるようになるまで - note.gosyujin.com - kk_Atakaの日記

    </title>

    
      <meta name="description" property="og:description" content="あらすじ Chefを触ってみたいと思いつつ、取っ掛かりを作るにはかなり用語が多いなーとウダウダしていたら、3/11にこんな本が出版されており。
 Amazon.co.jp： 入門Chef Solo - …">
    

    <meta name="apple-mobile-web-app-title" content="note.gosyujin.com - kk_Atakaの日記">

    <link rel="stylesheet" href="/css/primer-syntax.css">
    <link rel="stylesheet" href="/css/primer-build.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">
  </head>

  <body class="bg-gray">
    <div id="holy" class="container-lg bg-white h-100">

      <div id="header" class="px-1 bg-white">
        <nav class="UnderlineNav UnderlineNav--right px-2">
  <a class="UnderlineNav-actions muted-link" href="https://note.gosyujin.com">
    note.gosyujin.com - kk_Atakaの日記
  </a>

  
    

    <div class="UnderlineNav-body">
      
        
          <a class="UnderlineNav-item
            "

          href="/about/">
            
            <span>About</span>
          </a>
        
      
        
          <a class="UnderlineNav-item
            "

          href="/">
            
            <span>Archives</span>
          </a>
        
      
        
          <a class="UnderlineNav-item
            "

          href="/bookmark/">
            
            <span>Bookmark</span>
          </a>
        
      
        
          <a class="UnderlineNav-item
            "

          href="/tags/">
            
            <span>Tags</span>
          </a>
        
      
    </div>
  
</nav>

      </div>

      <div role="main" id="main" class="holy-main markdown-body px-4 bg-white">
        
  
  
    <div>
      <h1> 入門Chef Solo - Infrastructure as Code を読みながらChef Soloで遊べるようになるまで</h1>
      <div class="Subhead-description">
        
        
        <div>
  <ul>
    <li>
      Tags:
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/startup' class="muted-link">
      [<span class="Label Label--gray">StartUp</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/chef' class="muted-link">
      [<span class="Label Label--gray">Chef</span>]
    </a>
  


    </li>
    <li>
      初版発行:
      2013/04/01
    </li>
    <li>
      最終更新:
      
        2019/04/23
        <a href="https://github.com/gosyujin/gosyujin.github.io/commit/16c0ee03a21663362b8d2455d02f29dd80d37a68">postにold_url追加</a>
      
    </li>
  </ul>
</div>

      </div>
    </div>

    
  <div id="toc" class="Box Box--blue p-2 mb-3 mt-5">
    <h3>目次</h3>
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#あらすじ">あらすじ</a></li>
<li><a href="#環境-windows編">環境(Windows編)</a></li>
<li><a href="#手順">手順</a>
<ul>
<li><a href="#chef-インストール">Chef インストール</a></li>
<li><a href="#構成-レポジトリ-クックブック-レシピ">構成 レポジトリ、クックブック、レシピ</a>
<ul>
<li><a href="#レポジトリ作成-コピー">レポジトリ作成(コピー)</a></li>
<li><a href="#クックブック作成">クックブック作成</a></li>
<li><a href="#レシピ編集">レシピ編集</a></li>
</ul></li>
<li><a href="#その他設定色々-動かすためにもう少し">その他設定色々、動かすためにもう少し</a></li>
<li><a href="#実行">実行</a></li>
</ul></li>
<li><a href="#本当に何かインストールしてみる">本当に何かインストールしてみる</a></li>
<li><a href="#環境-linux編">環境(Linux編)</a></li>
<li><a href="#インストールテスト-zsh">インストールテスト(zsh)</a></li>
<li><a href="#インストールテスト-nginx">インストールテスト(nginx)</a>
<ul>
<li><a href="#service">service</a></li>
<li><a href="#template">template</a></li>
<li><a href="#cookbook-file">cookbook file</a></li>
<li><a href="#directory">directory</a></li>
<li><a href="#user">user</a></li>
<li><a href="#group">group</a></li>
<li><a href="#bash">bash</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>



    <article>
     <section class="pb-6 mb-3 border-bottom">
        

<h2 id="あらすじ">あらすじ</h2>

<p>Chefを触ってみたいと思いつつ、取っ掛かりを作るにはかなり用語が多いなーとウダウダしていたら、3/11にこんな本が出版されており。</p>

<ul>
<li><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00BSPH158/everlasting-22/ref=nosim/">Amazon.co.jp： 入門Chef Solo - Infrastructure as Code eBook: 伊藤直也: Kindleストア</a></li>
</ul>

<p>早速購入。</p>

<p>本書のはじめにはこんな事が書かれていました。</p>

<blockquote>
<p>公式ドキュメントがあまりにしっかり書かれすぎていることもあって「はじめの一歩」としてどの辺りを知ればいいのか、つまり「普通に使う分にはこの程度知っていればOK」というのがどの辺りなのかを掴むのが難しい…というのが筆者の個人的な印象です。</p>
</blockquote>

<p>はじめの一歩をどうしようか迷ってる場合オススメと……。</p>

<p>ではHello Worldしてみよう。</p>

<h2 id="環境-windows編">環境(Windows編)</h2>

<ul>
<li>Windows XP</li>
<li>Ruby 1.9.3</li>
<li>Rubygems 1.8.24</li>
</ul>

<h2 id="手順">手順</h2>

<h3 id="chef-インストール">Chef インストール</h3>

<p>ネットワークに繋がっていないぼっち環境のため、vendor/cacheディレクトリに必要なGemをありったけ放り込んでbundle install。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">$ bundle install --local --path vendor/bundle
Installing erubis (2.7.0)
Installing highline (1.6.16)
Installing json (1.7.7)
Installing mixlib-log (1.4.1)
Installing mixlib-authentication (1.3.0)
Installing mixlib-cli (1.3.0)
Installing mixlib-config (1.1.2)
Installing win32-api (1.4.8)
Installing windows-api (0.4.2)
Installing windows-pr (1.2.2)
Installing win32-process (0.6.6)
Installing mixlib-shellout (1.1.0)
Installing net-ssh (2.6.6)
Installing net-ssh-gateway (1.2.0)
Installing net-ssh-multi (1.1)
Installing ipaddress (0.8.0)
Installing systemu (2.5.2)
Installing yajl-ruby (1.1.0)
Installing ohai (6.16.0)
Installing mime-types (1.21)
Installing rest-client (1.6.7)
Installing chef (11.4.0)
Using bundler (1.3.1)</code></pre></div>
<h3 id="構成-レポジトリ-クックブック-レシピ">構成 レポジトリ、クックブック、レシピ</h3>

<p>Chefには <code>レポジトリ</code> , <code>クックブック</code> , <code>レシピ</code> という概念がある。</p>

<ul>
<li>レシピ: コード化された手順書</li>
<li>クックブック: 特定レシピのデータをまとめる</li>
<li>レポジトリ: クックブックを含めた全体</li>
</ul>

<h4 id="レポジトリ作成-コピー">レポジトリ作成(コピー)</h4>

<p>まずは、レポジトリのサンプルをGitHubから取得。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">$ git clone http://github.com/opscode/chef-repo.git</code></pre></div>
<p>中身はこんな感じ。それぞれの役目はまだわからない。</p>

<ul>
<li>LICENSE</li>
<li>README.md</li>
<li>Rakefile</li>
<li>certificates/</li>
<li>chefignore</li>
<li>config/</li>
<li>cookbooks/</li>
<li>data_bags/</li>
<li>environments/</li>
<li>roles/</li>
</ul>

<h4 id="クックブック作成">クックブック作成</h4>

<p>クックブックを作るためにはツール <code>knife</code> を使う。</p>

<p><code>knife</code> の初期設定。 <code>knife</code> はChefをインストールすれば使えるようになっている。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">$ bundle exec knife -h
Usage: knife sub-command (options)
    -s, --server-url URL             Chef Server URL
    -k, --key KEY                    API Client Key
        --[no-]color                 Use colored output, defaults to enabled
    -c, --config CONFIG              The configuration file to use
        --defaults                   Accept default values for all questions
    -d, --disable-editing            Do not open EDITOR, just accept the data as is
    -e, --editor EDITOR              Set the editor to use for interactive commands
    -E, --environment ENVIRONMENT    Set the Chef environment
    -F, --format FORMAT              Which format to use for output
    -u, --user USER                  API Client Username
        --print-after                Show the data after a destructive operation
    -V, --verbose                    More verbose output. Use twice for max verbosity
    -v, --version                    Show chef version
    -y, --yes                        Say yes to all prompts for confirmation
    -h, --help                       Show this message</code></pre></div>
<p>設定ファイルなど作成するために <code>knife configure</code> を実行。</p>

<p>色々聞かれるが、今はそのままでいい。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">$ bundle exec knife configure
WARNING: No knife configuration file found
Where should I put the config file? [C:/Documents and Settings/USER/.chef/knife.rb]
Please enter the chef server URL: [http://localhost:4000]
Please enter an existing username or clientname for the API: [USER] kk_Ataka
Please enter the validation clientname: [chef-validator]
Please enter the location of the validation key: [/etc/chef/validation.pem]
Please enter the path to a chef repository (or leave blank):
*****

You must place your client key in:
  C:/Documents and Settings/USER/.chef/kk_Ataka.pem
Before running commands with Knife!

*****

You must place your validation key in:
  C:/etc/chef/validation.pem
Before generating instance data with Knife!

*****
Configuration file written to C:/Documents and Settings/USER/.chef/knife.rb</code></pre></div>
<p>初期設定が終わったので、さっき落としたレポジトリの中でクックブックを作る。</p>

<p><code>knife cookbook create COOKBOOK_NAME -o COOKBOOK_DIR</code></p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">$ bundle exec knife cookbook create hello -o cookbooks
** Creating cookbook hello
** Creating README for cookbook: hello
** Creating CHANGELOG for cookbook: hello
** Creating metadata for cookbook: hello</code></pre></div>
<p>これで <code>chef-repo/cookbooks/hello</code> の中に以下のようなファイル。</p>

<ul>
<li>CHANGELOG.md</li>
<li>README.md</li>
<li>attributes/</li>
<li>definitions/</li>
<li>files/</li>
<li>libraries/</li>
<li>metadata.rb*</li>
<li>providers/</li>
<li>recipes/</li>
<li>resources/</li>
<li>templates/</li>
</ul>

<p><code>knife</code> コマンドも、生成されたファイルもまだ全然わからないけど、</p>

<ol>
<li>レポジトリを作成</li>
<li>クックブックを作成</li>
</ol>

<p>まではできたので、次はいよいよレシピを作成。</p>

<h4 id="レシピ編集">レシピ編集</h4>

<p>すでにひな形はできている。(コメントだけだけど) <code>chef-repo/cookbooks/hello/recipes/default.rb</code></p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1">#</span>
<span class="c1"># Cookbook Name:: hello</span>
<span class="c1"># Recipe:: default</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013, YOUR_COMPANY_NAME</span>
<span class="c1">#</span>
<span class="c1"># All rights reserved - Do Not Redistribute</span>
<span class="c1">#</span></code></pre></div>
<p>上記ファイルに追記。</p>

<p>はじめはlogでHello Worldを吐くだけのレシピを作成。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">log</span> <span class="s2">&#34;Hello World!&#34;</span></code></pre></div>
<h3 id="その他設定色々-動かすためにもう少し">その他設定色々、動かすためにもう少し</h3>

<p>レポジトリの直下 <code>chef-repo/</code> に どのレシピを実行するか指定するjsonファイルを作る。名前は <code>localhost.json</code> とした。</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="err">//</span> <span class="err">localhost.json</span>
<span class="p">{</span>
  <span class="nt">&#34;run_list&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;recipe[hello]&#34;</span> <span class="p">]</span>
<span class="p">}</span></code></pre></div>
<p>同じくレポジトリの直下に、テンポラリディレクトリの設定などを記述する <code>solo.rb</code> を作る。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1"># solo.rb</span>
<span class="n">file_cache_path</span> <span class="s2">&#34;C:/chef/tmp/chef-solo&#34;</span>
<span class="n">cookbook_path</span> <span class="o">[</span><span class="s2">&#34;C:/chef/chef-repo/cookbooks&#34;</span><span class="o">]</span></code></pre></div>
<h3 id="実行">実行</h3>

<p>…すると、Gemsが結構足りないのか、Load Errorが多発。</p>

<p>ffi がないって言われたり、ruby-wmiがないって言われたり、win32/serviceがないって言われたり…。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">$ bundle exec chef-solo -c solo.rb -j ./localhost.json
C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;:
cannot load such file -- win32/service (LoadError)
        from C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;
        from C:/chef/vendor/bundle/ruby/1.9.1/gems/chef-11.4.0/lib/chef/provider/service/windows.rb:24:in `&lt;top (required)&gt;&#39;
        from C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;
        from C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;
        from C:/chef/vendor/bundle/ruby/1.9.1/gems/chef-11.4.0/lib/chef/providers.rb:77:in `&lt;top (required)&gt;&#39;
        from C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;
        from C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;
        from C:/chef/vendor/bundle/ruby/1.9.1/gems/chef-11.4.0/lib/chef.rb:25:in
`&lt;top (required)&gt;&#39;
        from C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;
        from C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;
        from C:/chef/vendor/bundle/ruby/1.9.1/gems/chef-11.4.0/lib/chef/application/solo.rb:19:in `&lt;top (required)&gt;&#39;
        from C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;
        from C:/rubies/Ruby-193-p0/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:45:in `require&#39;
        from C:/chef/vendor/bundle/ruby/1.9.1/gems/chef-11.4.0/bin/chef-solo:23:in `&lt;top (required)&gt;&#39;
        from C:/chef/vendor/bundle/ruby/1.9.1/bin/chef-solo:23:in `load&#39;
        from C:/chef/vendor/bundle/ruby/1.9.1/bin/chef-solo:23:in `&lt;main&gt;&#39;</code></pre></div>
<p>色々調べてみる……。</p>

<ul>
<li><a href="http://stackoverflow.com/questions/12868121/cannot-load-such-file-ruby-wmi-loaderror-cannot-load-such-file-win32-s">windows - cannot load such file &ndash; ruby-wmi (LoadError) &amp; cannot load such file &ndash; win32/service (LoadError) - Stack Overflow</a></li>
<li><a href="http://wiki.opscode.com/display/chef/Common+Errors#CommonErrors-Nosuchfiletoloadrubywmi">Common Errors - Chef - Opscode Open Source Wiki</a></li>
</ul>

<p>最終的にGemfileはこうなった。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">source</span> <span class="ss">:rubygems</span>
<span class="n">source</span> <span class="s2">&#34;http://rubygems.org&#34;</span>

<span class="n">gem</span> <span class="s2">&#34;chef&#34;</span>
<span class="n">gem</span> <span class="s1">&#39;ffi&#39;</span>

<span class="n">gem</span> <span class="s2">&#34;win32-service&#34;</span>
<span class="n">gem</span> <span class="s2">&#34;ruby-wmi&#34;</span>
<span class="n">gem</span> <span class="s2">&#34;windows-api&#34;</span>
<span class="n">gem</span> <span class="s2">&#34;windows-pr&#34;</span>
<span class="n">gem</span> <span class="s2">&#34;rdp-ruby-wmi&#34;</span></code></pre></div>
<p>満を辞して！</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">$ bundle exec chef-solo -c solo.rb -j ./localhost.json
Starting Chef Client, version 11.4.0
[2013-03-22T17:32:30+09:00] WARN: unable to detect ip6address
Compiling Cookbooks...
Converging 1 resources
Recipe: hello::default
  * log[Hello World] action write

Chef Client finished, 1 resources updated</code></pre></div>
<h2 id="本当に何かインストールしてみる">本当に何かインストールしてみる</h2>

<p>ここからは、本当に何かをインストールしてみる。</p>

<p>……と同時に、サーバいじるんだからWindowsじゃなくていいよねということで構成変更。</p>

<h2 id="環境-linux編">環境(Linux編)</h2>

<ul>
<li>Red Hat Linux 5.4</li>
<li>Ruby 1.9.3</li>
<li>Rubygems 1.8.23</li>
</ul>

<h2 id="インストールテスト-zsh">インストールテスト(zsh)</h2>

<p>zshをchefでインストールしてみる。</p>

<p>ただし、外部に接続できないサーバなので、</p>

<ol>
<li>zshのrpmをダウンロードして</li>
<li>サーバに転送</li>
<li>chefでは(サーバ内の)ローカルにあるrpmを指定しインストール</li>
</ol>

<p>できるように準備。</p>

<p><code>chef-solo/cookbooks/hello/recipes/default.rb</code> にzshを追加。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">package</span> <span class="s2">&#34;zsh&#34;</span> <span class="k">do</span>
  <span class="n">action</span>   <span class="ss">:install</span>
  <span class="n">source</span>   <span class="s2">&#34;/home/kk_Ataka/zsh-3.0.5-6.i386.rpm&#34;</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Rpm</span>
<span class="k">end</span>
<span class="n">log</span> <span class="s2">&#34;Hello World&#34;</span></code></pre></div>
<p>通常は、 <code>action :install</code> だけで、chef側がrpmをよろしくやってくれるみたいだけど、今回はローカルのrpmを使うので、 <code>source</code> を指定してやる。</p>

<p>そして実行…あれ…なんかエラー出る。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"><span class="err">$</span> <span class="nx">bundle</span> <span class="nx">exec</span> <span class="nx">chef</span><span class="o">-</span><span class="nx">solo</span> <span class="o">-</span><span class="nx">c</span> <span class="nx">solo</span><span class="p">.</span><span class="nx">rb</span> <span class="o">-</span><span class="nx">j</span> <span class="nx">localhost</span><span class="p">.</span><span class="nx">json</span>
<span class="nx">The</span> <span class="nx">source</span> <span class="p">:</span><span class="nx">rubygems</span> <span class="nx">is</span> <span class="nx">deprecated</span> <span class="nx">because</span> <span class="nx">HTTP</span> <span class="nx">requests</span> <span class="nx">are</span> <span class="nx">insecure</span><span class="p">.</span>
<span class="nx">Please</span> <span class="nx">change</span> <span class="nx">your</span> <span class="nx">source</span> <span class="nx">to</span> <span class="err">&#39;</span><span class="nx">https</span><span class="p">:</span><span class="c1">//rubygems.org&#39; if possible, or &#39;http://rubygems.org&#39; if not.
</span><span class="c1"></span><span class="nx">Starting</span> <span class="nx">Chef</span> <span class="nx">Client</span><span class="p">,</span> <span class="nx">version</span> <span class="mf">11.4.0</span>
<span class="nx">Compiling</span> <span class="nx">Cookbooks</span><span class="o">...</span>
<span class="nx">Converging</span> <span class="mi">2</span> <span class="nx">resources</span>
<span class="nx">Recipe</span><span class="p">:</span> <span class="nx">hello</span><span class="p">::</span><span class="k">default</span>
  <span class="o">*</span> <span class="kn">package</span><span class="p">[</span><span class="nx">zsh</span><span class="p">]</span> <span class="nx">action</span> <span class="nx">install</span>
<span class="o">================================================================================</span>
<span class="nx">Error</span> <span class="nx">executing</span> <span class="nx">action</span> <span class="s">`install`</span> <span class="nx">on</span> <span class="nx">resource</span> <span class="err">&#39;</span><span class="kn">package</span><span class="p">[</span><span class="nx">zsh</span><span class="p">]</span><span class="err">&#39;</span>
<span class="o">================================================================================</span>


<span class="nx">Chef</span><span class="p">::</span><span class="nx">Exceptions</span><span class="p">::</span><span class="nx">Exec</span>
<span class="o">----------------------</span>
<span class="nx">rpm</span>  <span class="o">-</span><span class="nx">U</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kk_Ataka</span><span class="o">/</span><span class="nx">zsh</span><span class="o">-</span><span class="mf">3.0.5</span><span class="o">-</span><span class="m">6.i</span><span class="mf">386.</span><span class="nx">rpm</span> <span class="nx">returned</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">expected</span> <span class="mi">0</span>


<span class="nx">Resource</span> <span class="nx">Declaration</span><span class="p">:</span>
<span class="o">---------------------</span>
<span class="err">#</span> <span class="nx">In</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kk_Ataka</span><span class="o">/</span><span class="nx">chef</span><span class="o">/</span><span class="nx">chef</span><span class="o">-</span><span class="nx">repo</span><span class="o">/</span><span class="nx">cookbooks</span><span class="o">/</span><span class="nx">hello</span><span class="o">/</span><span class="nx">recipes</span><span class="o">/</span><span class="k">default</span><span class="p">.</span><span class="nx">rb</span>

  <span class="mi">9</span><span class="p">:</span> <span class="kn">package</span> <span class="s">&#34;zsh&#34;</span> <span class="nx">do</span>
 <span class="mi">10</span><span class="p">:</span>   <span class="nx">action</span>   <span class="p">:</span><span class="nx">install</span>
 <span class="mi">11</span><span class="p">:</span>   <span class="nx">source</span>   <span class="s">&#34;/home/kk_Ataka/zsh-3.0.5-6.i386.rpm&#34;</span>
 <span class="mi">12</span><span class="p">:</span>   <span class="nx">provider</span> <span class="nx">Chef</span><span class="p">::</span><span class="nx">Provider</span><span class="p">::</span><span class="nx">Package</span><span class="p">::</span><span class="nx">Rpm</span>
 <span class="mi">13</span><span class="p">:</span> <span class="nx">end</span>
 <span class="mi">14</span><span class="p">:</span> <span class="nx">log</span> <span class="s">&#34;Hello World&#34;</span>



<span class="nx">Compiled</span> <span class="nx">Resource</span><span class="p">:</span>
<span class="o">------------------</span>
<span class="err">#</span> <span class="nx">Declared</span> <span class="nx">in</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kk_Ataka</span><span class="o">/</span><span class="nx">chef</span><span class="o">/</span><span class="nx">chef</span><span class="o">-</span><span class="nx">repo</span><span class="o">/</span><span class="nx">cookbooks</span><span class="o">/</span><span class="nx">hello</span><span class="o">/</span><span class="nx">recipes</span><span class="o">/</span><span class="k">default</span><span class="p">.</span><span class="nx">rb</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span><span class="nx">in</span> <span class="err">`</span><span class="nx">from_file</span><span class="err">&#39;</span>

<span class="kn">package</span><span class="p">(</span><span class="s">&#34;zsh&#34;</span><span class="p">)</span> <span class="nx">do</span>
  <span class="nx">provider</span> <span class="nx">Chef</span><span class="p">::</span><span class="nx">Provider</span><span class="p">::</span><span class="nx">Package</span><span class="p">::</span><span class="nx">Rpm</span>
  <span class="nx">action</span> <span class="p">[:</span><span class="nx">install</span><span class="p">]</span>
  <span class="nx">retries</span> <span class="mi">0</span>
  <span class="nx">retry_delay</span> <span class="mi">2</span>
  <span class="nx">package_name</span> <span class="s">&#34;zsh&#34;</span>
  <span class="nx">source</span> <span class="s">&#34;/home/kk_Ataka/zsh-3.0.5-6.i386.rpm&#34;</span>
  <span class="nx">version</span> <span class="s">&#34;3.0.5-6&#34;</span>
  <span class="nx">cookbook_name</span> <span class="p">:</span><span class="nx">hello</span>
  <span class="nx">recipe_name</span> <span class="s">&#34;default&#34;</span>
<span class="nx">end</span>



<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">03</span><span class="o">-</span><span class="mi">25</span><span class="nx">T19</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mi">12</span><span class="o">+</span><span class="mi">09</span><span class="p">:</span><span class="mo">00</span><span class="p">]</span> <span class="nx">ERROR</span><span class="p">:</span> <span class="nx">Running</span> <span class="nx">exception</span> <span class="nx">handlers</span>
<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">03</span><span class="o">-</span><span class="mi">25</span><span class="nx">T19</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mi">12</span><span class="o">+</span><span class="mi">09</span><span class="p">:</span><span class="mo">00</span><span class="p">]</span> <span class="nx">ERROR</span><span class="p">:</span> <span class="nx">Exception</span> <span class="nx">handlers</span> <span class="nx">complete</span>
<span class="nx">Chef</span> <span class="nx">Client</span> <span class="nx">failed</span><span class="p">.</span> <span class="mi">0</span> <span class="nx">resources</span> <span class="nx">updated</span>
<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">03</span><span class="o">-</span><span class="mi">25</span><span class="nx">T19</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mi">12</span><span class="o">+</span><span class="mi">09</span><span class="p">:</span><span class="mo">00</span><span class="p">]</span> <span class="nx">FATAL</span><span class="p">:</span> <span class="nx">Stacktrace</span> <span class="nx">dumped</span> <span class="nx">to</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kk_Ataka</span><span class="o">/</span><span class="nx">chef</span><span class="o">/</span><span class="nx">chef</span><span class="o">-</span><span class="nx">repo</span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">chef</span><span class="o">-</span><span class="nx">solo</span><span class="o">/</span><span class="nx">chef</span><span class="o">-</span><span class="nx">stacktrace</span><span class="p">.</span><span class="nx">out</span>
<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">03</span><span class="o">-</span><span class="mi">25</span><span class="nx">T19</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mi">12</span><span class="o">+</span><span class="mi">09</span><span class="p">:</span><span class="mo">00</span><span class="p">]</span> <span class="nx">FATAL</span><span class="p">:</span> <span class="nx">Chef</span><span class="p">::</span><span class="nx">Exceptions</span><span class="p">::</span><span class="nx">Exec</span><span class="p">:</span> <span class="kn">package</span><span class="p">[</span><span class="nx">zsh</span><span class="p">]</span> <span class="p">(</span><span class="nx">hello</span><span class="p">::</span><span class="k">default</span> <span class="nx">line</span> <span class="mi">9</span><span class="p">)</span> <span class="nx">had</span> <span class="nx">an</span> <span class="kt">error</span><span class="p">:</span> <span class="nx">Chef</span><span class="p">::</span><span class="nx">Exceptions</span><span class="p">::</span><span class="nx">Exec</span><span class="p">:</span> <span class="nx">rpm</span>  <span class="o">-</span><span class="nx">U</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kk_Ataka</span><span class="o">/</span><span class="nx">zsh</span><span class="o">-</span><span class="mf">3.0.5</span><span class="o">-</span><span class="m">6.i</span><span class="mf">386.</span><span class="nx">rpm</span> <span class="nx">returned</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">expected</span> <span class="mi">0</span></code></pre></div>
<p>なんでだろ。あ、 <strong>一般ユーザだから</strong> か、そういえば？</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">$ rpm  -U /home/kk_Ataka/zsh-3.0.5-6.i386.rpm
エラー: can&#39;t create transaction lock on /var/lib/rpm/__db.000</code></pre></div>
<p>やはり。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"><span class="err">$</span> <span class="nx">su</span>
<span class="err">#</span> <span class="nx">bundle</span> <span class="nx">exec</span> <span class="nx">chef</span><span class="o">-</span><span class="nx">solo</span> <span class="o">-</span><span class="nx">c</span> <span class="nx">solo</span><span class="p">.</span><span class="nx">rb</span> <span class="o">-</span><span class="nx">j</span> <span class="nx">localhost</span><span class="p">.</span><span class="nx">json</span>
<span class="nx">Starting</span> <span class="nx">Chef</span> <span class="nx">Client</span><span class="p">,</span> <span class="nx">version</span> <span class="mf">11.4.0</span>
<span class="nx">Compiling</span> <span class="nx">Cookbooks</span><span class="o">...</span>
<span class="nx">Converging</span> <span class="mi">2</span> <span class="nx">resources</span>
<span class="nx">Recipe</span><span class="p">:</span> <span class="nx">hello</span><span class="p">::</span><span class="k">default</span>
  <span class="o">*</span> <span class="kn">package</span><span class="p">[</span><span class="nx">zsh</span><span class="p">]</span> <span class="nx">action</span> <span class="nx">install</span>
      <span class="o">-</span> <span class="nx">install</span> <span class="nx">version</span> <span class="mf">3.0.5</span><span class="o">-</span><span class="mi">6</span> <span class="nx">of</span> <span class="kn">package</span> <span class="nx">zsh</span>

        <span class="o">*</span> <span class="nx">log</span><span class="p">[</span><span class="nx">Hello</span> <span class="nx">World</span><span class="p">]</span> <span class="nx">action</span> <span class="nx">write</span>

    <span class="nx">Chef</span> <span class="nx">Client</span> <span class="nx">finished</span><span class="p">,</span> <span class="mi">2</span> <span class="nx">resources</span> <span class="nx">updated</span></code></pre></div>
<p>いったー。</p>

<h2 id="インストールテスト-nginx">インストールテスト(nginx)</h2>

<p>次にnginxを入れてみる。</p>

<p>レシピはインストールするパッケージ毎に分けた方がいいみたいなんだけど、今回は仮なので同じレシピに詰め込んでいく。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">package</span> <span class="s2">&#34;nginx&#34;</span> <span class="k">do</span>
  <span class="n">action</span>   <span class="ss">:install</span>
  <span class="n">source</span>   <span class="s2">&#34;/var/package/nginx-1.2.7-1.el5.ngx.i386.rpm&#34;</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Rpm</span>
<span class="k">end</span></code></pre></div>
<p>chef実行！</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">[2013-03-28T19:20:48+09:00] ERROR: Running exception handlers
[2013-03-28T19:20:48+09:00] ERROR: Exception handlers complete
Chef Client failed. 0 resources updated
[2013-03-28T15:20:48+09:00] FATAL: Stacktrace dumped to /home/kk_Ataka/chef/chef-repo/tmp/chef-solo/chef-stacktrace.out
[2013-03-28T19:20:48+09:00] FATAL: Chef::Exceptions::Exec: package[nginx] (hello::default line 18) had an error: Chef::Exceptions::Exec: rpm  -U /var/package/nginx-1.2.7-1.el5.ngx.i386.rpm returned 1, expected 0</code></pre></div>
<p>だめ？何だこのエラー…直接rpmできるか確認してみるか。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">rpm -ivh /var/package/nginx-1.2.7-1.el5.ngx.i386.rpm
警告: /var/package/nginx-1.2.7-1.el5.ngx.i386.rpm: ヘッダ V3 RSA/SHA1 signature: NOKEY, key ID 7bd9bf62
エラー: 依存性の欠如:
        libpcre.so.0 は nginx-1.2.7-1.el5.ngx.i386 に必要とされています</code></pre></div>
<p>あ、ライブラリが足りないのか。PCREをDLしてインストールする必要があるのね</p>

<p>まずはnginxとその依存ファイルをインストールするように書いてみた。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">package</span> <span class="s2">&#34;pcre&#34;</span> <span class="k">do</span>
  <span class="n">action</span>   <span class="ss">:install</span>
  <span class="n">source</span>   <span class="s2">&#34;/var/package/pcre-6.6-6.el5_6.1.i386.rpm&#34;</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Rpm</span>
<span class="k">end</span>

<span class="n">package</span> <span class="s2">&#34;pcre-devel&#34;</span> <span class="k">do</span>
  <span class="n">action</span>   <span class="ss">:install</span>
  <span class="n">source</span>   <span class="s2">&#34;/var/package/pcre-devel-6.6-6.el5_6.1.i386.rpm&#34;</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Rpm</span>
<span class="k">end</span>

<span class="n">package</span> <span class="s2">&#34;nginx&#34;</span> <span class="k">do</span>
  <span class="n">action</span>   <span class="ss">:install</span>
  <span class="n">source</span>   <span class="s2">&#34;/var/package/nginx-1.2.7-1.el5.ngx.i386.rpm&#34;</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Rpm</span>
<span class="k">end</span></code></pre></div>
<p>で、インストール。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"><span class="err">#</span> <span class="nx">bundle</span> <span class="nx">exec</span> <span class="nx">chef</span><span class="o">-</span><span class="nx">solo</span> <span class="o">-</span><span class="nx">c</span> <span class="nx">solo</span><span class="p">.</span><span class="nx">rb</span> <span class="o">-</span><span class="nx">j</span> <span class="nx">localhost</span><span class="p">.</span><span class="nx">json</span>
<span class="nx">Starting</span> <span class="nx">Chef</span> <span class="nx">Client</span><span class="p">,</span> <span class="nx">version</span> <span class="mf">11.4.0</span>
<span class="nx">Compiling</span> <span class="nx">Cookbooks</span><span class="o">...</span>
<span class="nx">Converging</span> <span class="mi">4</span> <span class="nx">resources</span>
<span class="nx">Recipe</span><span class="p">:</span> <span class="nx">hello</span><span class="p">::</span><span class="k">default</span>
  <span class="o">*</span> <span class="kn">package</span><span class="p">[</span><span class="nx">zsh</span><span class="p">]</span> <span class="nx">action</span> <span class="nx">install</span>
    <span class="o">-</span> <span class="nx">install</span> <span class="nx">version</span> <span class="mf">3.0.5</span><span class="o">-</span><span class="mi">6</span> <span class="nx">of</span> <span class="kn">package</span> <span class="nx">zsh</span>

  <span class="o">*</span> <span class="kn">package</span><span class="p">[</span><span class="nx">pcre</span><span class="p">]</span> <span class="nx">action</span> <span class="nx">install</span> 
    <span class="o">-</span> <span class="nx">install</span> <span class="nx">version</span> <span class="mf">6.6</span><span class="o">-</span><span class="mf">6.</span><span class="nx">el5_6</span><span class="mf">.1</span> <span class="nx">of</span> <span class="kn">package</span> <span class="nx">pcre</span>

  <span class="o">*</span> <span class="kn">package</span><span class="p">[</span><span class="nx">pcre</span><span class="o">-</span><span class="nx">devel</span><span class="p">]</span> <span class="nx">action</span> <span class="nx">install</span>
    <span class="o">-</span> <span class="nx">install</span> <span class="nx">version</span> <span class="mf">6.6</span><span class="o">-</span><span class="mf">6.</span><span class="nx">el5_6</span><span class="mf">.1</span> <span class="nx">of</span> <span class="kn">package</span> <span class="nx">pcre</span><span class="o">-</span><span class="nx">devel</span>

  <span class="o">*</span> <span class="kn">package</span><span class="p">[</span><span class="nx">nginx</span><span class="p">]</span> <span class="nx">action</span> <span class="nx">install</span>
    <span class="o">-</span> <span class="nx">install</span> <span class="nx">version</span> <span class="mf">1.2.7</span><span class="o">-</span><span class="mf">1.</span><span class="nx">el5</span><span class="p">.</span><span class="nx">ngx</span> <span class="nx">of</span> <span class="kn">package</span> <span class="nx">nginx</span></code></pre></div>
<p>はいった！んでnginxがあるかどうか確認…。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># nginx -v
nginx version: nginx/1.2.7</code></pre></div>
<p>ある！じゃあ起動。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># /etc/init.d/nginx start
nginx を起動中:                                            [  OK  ]</code></pre></div>
<p>きたーーー！</p>

<h3 id="service">service</h3>

<p>今までレシピには <code>package</code> と <code>log</code> しか使っていなかった。</p>

<p>次に、 <code>service</code> の定義方法を確認。</p>

<p>serviceを定義する事でサービス周りの操作をできる。</p>

<p>例えば、サービス自動起動の設定はなんにもしないとこうなってる。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># chkconfig --list | grep nginx
nginx           0:off   1:off   2:on    3:on    4:on    5:on    6:off</code></pre></div>
<p>レシピのservice &gt; <code>action</code> を <code>:disable</code> にして再インストールすると。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">service</span> <span class="s2">&#34;nginx&#34;</span> <span class="k">do</span>
  <span class="n">action</span>   <span class="o">[</span> <span class="ss">:disable</span> <span class="o">]</span>
<span class="k">end</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">  * package[nginx] action install (up to date)
  * service[nginx] action disable
    - disable service service[nginx]</code></pre></div>
<p>サービスが無効になる。逆に <code>:enable</code>にしてみる。プラス、 <code>start</code> もつけてみる。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">service</span> <span class="s2">&#34;nginx&#34;</span> <span class="k">do</span>
  <span class="n">action</span>   <span class="o">[</span> <span class="ss">:enable</span><span class="p">,</span> <span class="ss">:start</span> <span class="o">]</span>
<span class="k">end</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># chkconfig --list | grep nginx
nginx           0:off   1:off   2:off   3:off   4:off   5:off   6:off</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">  * package[nginx] action install (up to date)
  * service[nginx] action enable
    - enable service service[nginx]

  * service[nginx] action start
    - start service service[nginx]</code></pre></div>
<p>起動時にサービスが上がるようになり、chefコマンド実行後にnginxが起動状態となっている。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># chkconfig --list | grep nginx
nginx           0:off   1:off   2:on    3:on    4:on    5:on    6:off
# /etc/init.d/nginx status
nginx (pid  20026) を実行中...</code></pre></div>
<p>次に <code>supports</code> 。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">service</span> <span class="s2">&#34;nginx&#34;</span> <span class="k">do</span>
  <span class="n">supports</span> <span class="ss">:status</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:restart</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:reload</span> <span class="o">=&gt;</span> <span class="kp">true</span>
  <span class="n">action</span>   <span class="o">[</span> <span class="ss">:enable</span><span class="p">,</span> <span class="ss">:start</span> <span class="o">]</span>
<span class="k">end</span></code></pre></div>
<p>これは、「他のリソースに、このサービスが使えるオプションを教える」ためのもの…らしい。</p>

<p>なくても動くが、指定しておくと吉という事。まだシチュエーションがよくわかっていない。</p>

<h3 id="template">template</h3>

<p>設定ファイルを配備する。</p>

<p>例えば、 <code>/etc/nginx/nginx.conf</code> はそのまま入れるとこうなっている。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># ls -l /etc/nginx/nginx.conf
-rw-r--r-- 1 root root 643  2月 12 22:57 /etc/nginx/nginx.conf</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-nginx" data-lang="nginx"><span class="c1"># cat /etc/nginx/nginx.conf
</span><span class="c1"></span><span class="k">user</span>  <span class="s">nginx</span><span class="p">;</span>
<span class="k">worker_processes</span>  <span class="mi">1</span><span class="p">;</span>

<span class="k">error_log</span>  <span class="s">/var/log/nginx/error.log</span> <span class="s">warn</span><span class="p">;</span>
<span class="k">pid</span>        <span class="s">/var/run/nginx.pid</span><span class="p">;</span>


<span class="k">events</span> <span class="p">{</span>
    <span class="kn">worker_connections</span>  <span class="mi">1024</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">http</span> <span class="p">{</span>
    <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
    <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>

    <span class="kn">log_format</span>  <span class="s">main</span>  <span class="s">&#39;</span><span class="nv">$remote_addr</span> <span class="s">-</span> <span class="nv">$remote_user</span> <span class="s">[</span><span class="nv">$time_local]</span> <span class="s">&#34;</span><span class="nv">$request&#34;</span> <span class="s">&#39;</span>
                      <span class="s">&#39;</span><span class="nv">$status</span> <span class="nv">$body_bytes_sent</span> <span class="s">&#34;</span><span class="nv">$http_referer&#34;</span> <span class="s">&#39;</span>
                      <span class="s">&#39;&#34;</span><span class="nv">$http_user_agent&#34;</span> <span class="s">&#34;</span><span class="nv">$http_x_forwarded_for&#34;&#39;</span><span class="p">;</span>

    <span class="kn">access_log</span>  <span class="s">/var/log/nginx/access.log</span>  <span class="s">main</span><span class="p">;</span>

    <span class="kn">sendfile</span>        <span class="no">on</span><span class="p">;</span>
    <span class="c1">#tcp_nopush     on;
</span><span class="c1"></span>
    <span class="kn">keepalive_timeout</span>  <span class="mi">65</span><span class="p">;</span>

    <span class="c1">#gzip  on;
</span><span class="c1"></span>
    <span class="kn">include</span> <span class="s">/etc/nginx/conf.d/*.conf</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>
<p>これをパーミッションから内容から色々操作したい。</p>

<p>そんな時にレシピ <code>template</code> を追記。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">template</span> <span class="s2">&#34;nginx.conf&#34;</span> <span class="k">do</span>
  <span class="n">path</span>     <span class="s2">&#34;/etc/nginx/nginx.conf&#34;</span>
  <span class="n">source</span>   <span class="s2">&#34;nginx.conf.erb&#34;</span>
  <span class="n">owner</span>    <span class="s2">&#34;root&#34;</span>
  <span class="n">group</span>    <span class="s2">&#34;root&#34;</span>
  <span class="n">mode</span>     <span class="mo">0644</span>
<span class="k">end</span></code></pre></div>
<p><code>source</code> が今回使うテンプレートとなる。ファイル名しか書いていないが、クックブック内の <code>templates/default/</code> 下が読まれる様子。</p>

<p>また、 <code>source</code> を書かないと、Chefが <code>nginx.conf.erb</code> を探しに行くみたい。この時の前半部 <code>nginx.conf</code> は template の nginx.conf から来ているんだろうか。</p>

<p>で、 <code>templates/default/nginx.conf.erb</code> を作成する。</p>
<div class="highlight"><pre class="chroma"><code class="language-nginx" data-lang="nginx"><span class="k">user</span>            <span class="s">nginx</span><span class="p">;</span>
<span class="k">worker_processes</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">error_log</span>       <span class="s">/var/log/nginx/error.log</span><span class="p">;</span>
<span class="k">pid</span>             <span class="s">/var/run/nginx.pid</span><span class="p">;</span>

<span class="k">events</span> <span class="p">{</span>
  <span class="kn">worker_connections</span> <span class="mi">1024</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">http</span> <span class="p">{</span>
  <span class="kn">include</span>       <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
  <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>
  <span class="kn">server</span> <span class="p">{</span>
    <span class="kn">listen</span>      <span class="s">&lt;%=</span> <span class="s">node[&#39;nginx&#39;][&#39;port&#39;]</span> <span class="s">%&gt;</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>
    <span class="kn">location</span> <span class="s">/</span>  <span class="p">{</span>
      <span class="kn">root</span>  <span class="s">/usr/share/nginx/html</span><span class="p">;</span>
      <span class="kn">index</span> <span class="s">index.htm</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>基本的には、思うままに設定ファイルを作成するだけ。</p>

<p>ただし、一点特徴として、設定ファイルの中に <code>Attribute</code> が使える。変数を埋め込んで展開できる。</p>

<p>上記のファイルでは <code>listen</code> の値を <code>&lt;%= node['nginx']['port'] %&gt;</code> としてある。</p>

<p>これはどこに定義しているかというと……。</p>

<p>レポジトリ直下に作っていた <code>localhost.json</code> に定義している。</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="err">//</span> <span class="err">localhost.json</span>
<span class="p">{</span>
  <span class="nt">&#34;nginx&#34;</span>    <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;port&#34;</span> <span class="p">:</span> <span class="mi">8090</span> <span class="p">},</span>
  <span class="nt">&#34;run_list&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;recipe[hello]&#34;</span> <span class="p">]</span>
<span class="p">}</span></code></pre></div>
<p>これが使われる。</p>

<p>んで、templateを使ってchef実行！</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># bundle exec chef-solo -c solo.rb -j localhost.json
Starting Chef Client, version 11.4.0
Compiling Cookbooks...
Converging 6 resources
Recipe: hello::default
  * package[zsh] action install (up to date)
  * package[pcre] action install (up to date)
  * package[pcre-devel] action install (up to date)
  * package[nginx] action install (up to date)
  * service[nginx] action enable (up to date)
  * service[nginx] action start (up to date)
  * template[nginx.conf] action create
    - update template[nginx.conf] from 772e91 to acb62b
        --- /etc/nginx/nginx.conf       2013-03-29 19:05:50.000000000 +0900
        +++ /tmp/chef-rendered-template20130329-1313-3044nz     2013-03-29 19:05:56.000000000 +0900
        @@ -1,32 +1,21 @@
        -
        -user  nginx;
        -worker_processes  1;
        -
        -error_log  /var/log/nginx/error.log warn;
        -pid        /var/run/nginx.pid;
        -
        +user            nginx;
        +worker_processes 1;
        +error_log       /var/log/nginx/error.log;
        +pid             /var/run/nginx.pid;

         events {
        -    worker_connections  1024;
        +  worker_connections 1024;
         }

        -
         http {
        -    include       /etc/nginx/mime.types;
        -    default_type  application/octet-stream;
        -
        -    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; &#39;
        -                      &#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;
        -                      &#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34;&#39;;
        -
        -    access_log  /var/log/nginx/access.log  main;
        -
        -    sendfile        on;
        -    #tcp_nopush     on;
        -
        -    keepalive_timeout  65;
        -
        -    #gzip  on;
        -
        -    include /etc/nginx/conf.d/*.conf;
        +  include      /etc/nginx/mime.types;
        +  default_type application/octet-stream;
        +  server {
        +    listen      8090;
        +    server_name localhost;
        +    location / {
        +      root  /usr/share/nginx/html;
        +      index index.htm;
        +    }
        +  }
         }</code></pre></div>
<p>お、置き換わったっぽい。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># ls -l /etc/nginx/nginx.conf
-rw-r--r-- 1 root root 392  3月 29 19:05 /etc/nginx/nginx.conf</code></pre></div>
<p>644のroot:rootになってる。</p>

<p>中身は……。</p>
<div class="highlight"><pre class="chroma"><code class="language-nginx" data-lang="nginx"><span class="k">user</span>            <span class="s">nginx</span><span class="p">;</span>
<span class="k">worker_processes</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">error_log</span>       <span class="s">/var/log/nginx/error.log</span><span class="p">;</span>
<span class="k">pid</span>             <span class="s">/var/run/nginx.pid</span><span class="p">;</span>

<span class="k">events</span> <span class="p">{</span>
  <span class="kn">worker_connections</span> <span class="mi">1024</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">http</span> <span class="p">{</span>
  <span class="kn">include</span>      <span class="s">/etc/nginx/mime.types</span><span class="p">;</span>
  <span class="kn">default_type</span> <span class="s">application/octet-stream</span><span class="p">;</span>
  <span class="kn">server</span> <span class="p">{</span>
    <span class="kn">listen</span>      <span class="mi">8090</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>
    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
      <span class="kn">root</span>  <span class="s">/usr/share/nginx/html</span><span class="p">;</span>
      <span class="kn">index</span> <span class="s">index.htm</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>置き変わってる。listen ポートも8090になってる。</p>

<p><code>notifies</code> の話はまた今度。</p>

<h3 id="cookbook-file">cookbook file</h3>

<p>クックブック内のファイルをサーバの特定の場所に配備。</p>

<p>まず、クックブックの <code>files/default</code> ディレクトリにファイルを作る。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># touch cookbooks/hello/files/default/README
# echo &#34;this is readme file&#34; &gt;&gt; cookbooks/hello/files/default/README</code></pre></div>
<p>これをレシピに <code>cookbook_file</code> として記載。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">cookbook_file</span> <span class="s2">&#34;/tmp/README&#34;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="mo">00444</span>
<span class="k">end</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># bundle exec chef-solo -c solo.rb -j localhost.json
(略)
  * template[nginx.conf] action create (up to date)
  * cookbook_file[/tmp/README] action create
    - create a new cookbook_file /tmp/README
        --- /tmp/chef-tempfile20130329-2216-1jqt4bi     2013-03-29 23:41:59.000000000 +0900
        +++ /home/kk_Ataka/chef/chef-repo/cookbooks/hello/files/default/README     2013-03-29 23:37:45.000000000 +0900
        @@ -0,0 +1 @@
        +this is readme file

Chef Client finished, 1 resources updated</code></pre></div>
<p>できてるかな？</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># ls -l /tmp/README
-r--r--r-- 1 root root 20  3月 29 23:41 /tmp/README
# cat /tmp/README
this is readme file</code></pre></div>
<p>おーできてる。</p>

<p>他にも <code>source</code> , <code>owner</code> , <code>group</code> , <code>path</code> , <code>checksum</code> などを指定できる。</p>

<p>checksumは <code>SHA-256</code> が使われる。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># sha256sum cookbooks/hello/files/default/README
ee55fd3276ac9361a6e632e100dba72bfa34c06f8feb2c3f8d8ae95f06941bf0  cookbooks/hello/files/default/README</code></pre></div>
<p>ほい。これをレシピに指定。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">cookbook_file</span> <span class="s2">&#34;/tmp/README&#34;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="mo">00444</span>
  <span class="n">checksum</span> <span class="s2">&#34;ee55fd3276ac9361a6e632e100dba72bfa34c06f8feb2c3f8d8ae95f06941bf0&#34;</span>
<span class="k">end</span></code></pre></div>
<p>問題がなければ、何事もなく。checksumを誤ると……。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">cookbook_file</span> <span class="s2">&#34;/tmp/README&#34;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="mo">00444</span>
  <span class="n">checksum</span> <span class="s2">&#34;hoge&#34;</span>
<span class="k">end</span></code></pre></div>
<p>エラーとなる。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># bundle exec chef-solo -c solo.rb -j localhost.json
Starting Chef Client, version 11.4.0
Compiling Cookbooks...

================================================================================
Recipe Compile Error in /home/kk_Ataka/chef/chef-repo/cookbooks/hello/recipes/default.rb
================================================================================


Chef::Exceptions::ValidationFailed
----------------------------------
Option checksum&#39;s value hoge does not match regular expression /^[a-zA-Z0-9]{64}$/


Cookbook Trace:
---------------
  /home/kk_Ataka/chef/chef-repo/cookbooks/hello/recipes/default.rb:49:in `block in from_file&#39;
  /home/kk_Ataka/chef/chef-repo/cookbooks/hello/recipes/default.rb:47:in `from_file&#39;


Relevant File Content:
----------------------
/home/kk_Ataka/chef/chef-repo/cookbooks/hello/recipes/default.rb:

 42:    group    &#34;root&#34;
 43:    mode     0644
 44:  #  notifies :reload, &#39;service[nginx]&#39;
 45:  end
 46:
 47:  cookbook_file &#34;/tmp/README&#34; do
 48:    mode 00444
 49&gt;&gt;   checksum &#34;hoge&#34;
 50:  end
 51:


[2013-03-29T23:53:54+09:00] ERROR: Running exception handlers
[2013-03-29T23:53:54+09:00] ERROR: Exception handlers complete
Chef Client failed. 0 resources updated
[2013-03-29T23:53:54+09:00] FATAL: Stacktrace dumped to /home/kk_Ataka/chef/chef-repo/tmp/chef-solo/chef-stacktrace.out
[2013-03-29T23:53:54+09:00] FATAL: Chef::Exceptions::ValidationFailed: Option checksum&#39;s value hoge does not match regular expression /^[a-zA-Z0-9]{64}$/</code></pre></div>
<h3 id="directory">directory</h3>

<p>そのもの、ディレクトリを作る または 削除する。レシピはこう。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">directory</span> <span class="s2">&#34;/tmp/mydirectory&#34;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="mo">00755</span>
  <span class="n">owner</span> <span class="s2">&#34;kk_Ataka&#34;</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span></code></pre></div>
<p><code>action</code> に作るか消すかを設定、 <code>:create</code> か <code>:delete</code> を指定。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># bundle exec chef-solo -c solo.rb -j localhost.json
(略)
  * directory[/tmp/mydirectory] action create
    - create new directory /tmp/mydirectory
    - change mode from &#39;&#39; to &#39;0755&#39;
    - change owner from &#39;&#39; to &#39;kk_Ataka&#39;</code></pre></div>
<p>できた。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console"># ls -l /tmp/
drwxr-xr-x  2 kk_Ataka root 4096  3月 29 23:03 mydirectory</code></pre></div>
<p>ところで、レシピを記述する順番とかは意識する必要があるんだろうか。</p>

<ul>
<li>README を <code>/tmp/mydirectory</code> に置きたい</li>
<li><code>/tmp/mydirectory</code> はレシピで作る(今はない)</li>
</ul>

<p>後でディレクトリを作る。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">cookbook_file</span> <span class="s2">&#34;/tmp/mydirectory/README&#34;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="mo">00444</span>
  <span class="n">checksum</span> <span class="s2">&#34;ee55fd3276ac9361a6e632e100dba72bfa34c06f8feb2c3f8d8ae95f06941bf0&#34;</span>
<span class="k">end</span>
<span class="n">directory</span> <span class="s2">&#34;/tmp/mydirectory&#34;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="mo">00755</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span></code></pre></div>
<p>結果、ダメ。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">[2013-03-29T23:11:39+09:00] ERROR: Running exception handlers
[2013-03-29T23:11:39+09:00] ERROR: Exception handlers complete
Chef Client failed. 0 resources updated
[2013-03-29T23:11:39+09:00] FATAL: Stacktrace dumped to /home/kk_Ataka/chef/chef-repo/tmp/chef-solo/chef-stacktrace.out
[2013-03-29T23:11:39+09:00] FATAL: Chef::Exceptions::EnclosingDirectoryDoesNotExist: cookbook_file[/tmp/mydirectory/README] (hello::default line 47) had an error: Chef::Exceptions::EnclosingDirectoryDoesNotExist: Parent directory /tmp/mydirectory does not exist.</code></pre></div>
<p>先にディレクトリを作る。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">directory</span> <span class="s2">&#34;/tmp/mydirectory&#34;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="mo">00755</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
<span class="n">cookbook_file</span> <span class="s2">&#34;/tmp/mydirectory/README&#34;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="mo">00444</span>
  <span class="n">checksum</span> <span class="s2">&#34;ee55fd3276ac9361a6e632e100dba72bfa34c06f8feb2c3f8d8ae95f06941bf0&#34;</span>
<span class="k">end</span></code></pre></div>
<p>結果、いけた。</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">  * directory[/tmp/mydirectory] action create
    - create new directory /tmp/mydirectory
    - change mode from &#39;&#39; to &#39;0755&#39;

  * cookbook_file[/tmp/mydirectory/README] action create
    - create a new cookbook_file /tmp/mydirectory/README
        --- /tmp/chef-tempfile20130329-4457-myq1xs      2013-03-29 23:13:10.000000000 +0900
        +++ /home/kk_Ataka/chef/chef-repo/cookbooks/hello/files/default/README     2013-03-29 23:37:45.000000000 +0900
        @@ -0,0 +1 @@
        +this is readme file

Chef Client finished, 2 resources updated
# ls -l /tmp/
合計 8
drwxr-xr-x  2 root root 4096  3月 29 23:13 mydirectory
# ls -l /tmp/mydirectory/
合計 4
-r--r--r-- 1 root root 20  3月 29 23:13 README

# cat /tmp/mydirectory/README
this is readme file</code></pre></div>
<ul>
<li>存在しないディレクトリを作ったりという事は、Chefではよろしくやってくれない</li>
<li>必要なディレクトリなどは先に作っておく必要がある</li>
</ul>

<p>ということかな。</p>

<h3 id="user">user</h3>

<p>ユーザ作成。 <code>action</code> は <code>:create</code> の場合省略していいみたい。削除する場合は <code>:remove</code> 修正もできるが一旦置いておく。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">user</span> <span class="s2">&#34;ataka_man&#34;</span> <span class="k">do</span>
  <span class="n">action</span>   <span class="ss">:create</span>
  <span class="n">comment</span>  <span class="s2">&#34;from_chef&#34;</span>
  <span class="n">home</span>     <span class="s2">&#34;/home/ataka_man&#34;</span>
  <span class="n">shell</span>    <span class="s2">&#34;/bin/bash&#34;</span>
  <span class="n">password</span> <span class="kp">nil</span>
<span class="k">end</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">  * user[ataka_man] action create
    - create user user[ataka_man]</code></pre></div>
<h3 id="group">group</h3>

<p>グループもユーザ同様作成できる。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">group</span> <span class="s2">&#34;xenoblade&#34;</span> <span class="k">do</span>
  <span class="n">action</span>  <span class="ss">:create</span>
  <span class="n">gid</span>     <span class="mi">999</span>
  <span class="n">members</span> <span class="o">[</span><span class="s2">&#34;ataka_man&#34;</span><span class="o">]</span>
<span class="k">end</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">  * group[xenoblade] action create
    - create group[xenoblade]</code></pre></div>
<h3 id="bash">bash</h3>

<p>bashを使う事も出来る。が、「あるべき状態」に持っていくのがたいへんなので、ご利用は計画的に。</p>
<div class="highlight"><pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">bash</span> <span class="s2">&#34;make_echofile_in homedir&#34;</span> <span class="k">do</span>
  <span class="n">user</span> <span class="s2">&#34;kk_Ataka&#34;</span>
  <span class="n">group</span> <span class="s2">&#34;kk_Ataka&#34;</span>
  <span class="n">cwd</span> <span class="s2">&#34;/&#34;</span>
  <span class="n">environment</span> <span class="s2">&#34;HOGE_PATH&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;/home/kk_Ataka/&#34;</span>
  <span class="n">code</span> <span class="s">&lt;&lt;-EOC
</span><span class="s"></span>    <span class="n">cd</span> <span class="vg">$HOGE_PATH</span>
    <span class="n">touch</span> <span class="n">hello</span>
    <span class="n">chmod</span> <span class="mi">777</span> <span class="n">hello</span>
    <span class="n">echo</span> <span class="s2">&#34;#!/bin/bash&#34;</span> <span class="o">&gt;&gt;</span> <span class="n">hello</span>
    <span class="n">echo</span> <span class="s2">&#34;echo hello&#34;</span>  <span class="o">&gt;&gt;</span> <span class="n">hello</span>
  <span class="no">EOC</span>
  <span class="n">creates</span> <span class="s2">&#34;/home/kk_Ataka/hello&#34;</span>
<span class="k">end</span></code></pre></div>
<p><code>cwd</code> はカレントワーキングディレクトリ、 <code>environment</code> は環境変数を指定できる。</p>

<p><code>code</code> に実行したいコマンドを記述。</p>

<p>ここでは、</p>

<ol>
<li><code>environment</code> に記載したパスに移動</li>
<li>hello ファイルを作成</li>
<li>実行権限変更</li>
<li>echo文追加</li>
</ol>

<p>している。</p>

<p>最後の <code>creates</code> は <strong>creates に定義したコマンドがある(実行できる)場合は、このリソースを実行しない</strong> という判断のために使用される。</p>

<p>上記のレシピを実行すると、初回は</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">  * bash[make_echofile_in homedir] action run
    - execute &#34;bash&#34;  &#34;/tmp/chef-script20130329-11001-k8nowp&#34;</code></pre></div>
<p>実行されるが、2回目以降は</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">  * bash[make_echofile_in homedir] action run</code></pre></div>
<p>こうなる。2回目以降は /home/kk_Ataka/hello が実行できるから、リソースを実行しない事になっている。</p>

<p>しかし、 <code>creates</code> をコメントアウトすると</p>
<div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">  * bash[make_echofile_in homedir] action run
    - execute &#34;bash&#34;  &#34;/tmp/chef-script20130329-11473-1bf7sg9&#34;</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-console" data-lang="console">  * bash[make_echofile_in homedir] action run
    - execute &#34;bash&#34;  &#34;/tmp/chef-script20130329-xxxxx-xxxxxxx&#34;</code></pre></div>
<p>何度もexecuteされる。helloファイルも作成され続ける。</p>

<p>ここまでで、本書の2, 3, 9-13, 15辺りをひと通り触った事になる。</p>

      </section>
    </article>

    <div class="Subhead-description">
      
      <nav class="paginate-container">
  <div class="pagination">
      
        <a href="https://note.gosyujin.com/2013/03/18/selenium-firefox-loaderror/" class="pagination_overflow previous_page">
          Prev: 
          13/3/18
          Selenium WebDriverでFirefoxがロード …
        </a>
      

      <a href="https://note.gosyujin.com" class="pagination_center">
        Archives
      </a>
      </span>

      
        <a href="https://note.gosyujin.com/2013/04/11/jekyll-0120/" class="pagination_overflow next_page">
          Next: 
          13/4/11
          Jekyllのバージョンを 0.12.0 にあげた
        </a>
      
  </div>
</nav>

      



<h2>関連記事(この記事の初版より古い記事はリンクがグレーで表示されます)</h2>
<ol>
  
    
      <li class="newer-post">
    
      <span>2013/08/09 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/redmine' class="muted-link">
      [<span class="Label Label--gray">Redmine</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/mysql' class="muted-link">
      [<span class="Label Label--gray">MySql</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/startup' class="muted-link">
      [<span class="Label Label--gray">StartUp</span>]
    </a>
  



      <a class="mb-2" href="/2013/08/09/redmine2/">WindowsにRedmine2.3をインストールする手順と、プラグイン作成用メモ</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/04/27 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/chef' class="muted-link">
      [<span class="Label Label--gray">Chef</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88' class="muted-link">
      [<span class="Label Label--gray">イベント</span>]
    </a>
  



      <a class="mb-2" href="/2013/04/27/bpstudy68/">BPStudy#68に参加しました #bpstudy</a>
    </li>
  
    
      <li class="older-post">
    
      <span>2013/02/25 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/startup' class="muted-link">
      [<span class="Label Label--gray">StartUp</span>]
    </a>
  



      <a class="mb-2" href="/2013/02/25/ruby200-helloworld-pik-rvm/">Ruby 2.0.0 をpikとrvm経由でインストール&amp;環境構築</a>
    </li>
  
    
      <li class="older-post">
    
      <span>2012/09/20 </span>
      


  
    <a href='https://note.gosyujin.com/tags/jekyll' class="muted-link">
      [<span class="Label Label--gray">Jekyll</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/startup' class="muted-link">
      [<span class="Label Label--gray">StartUp</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  



      <a class="mb-2" href="/2012/09/20/jekyll/">JekyllをGitHub Pagesに上げるための準備</a>
    </li>
  
    
      <li class="older-post">
    
      <span>2012/09/14 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/startup' class="muted-link">
      [<span class="Label Label--gray">StartUp</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/jekyll' class="muted-link">
      [<span class="Label Label--gray">Jekyll</span>]
    </a>
  



      <a class="mb-2" href="/2012/09/14/1347595853/">JekyllとJekyll Bootstrapでかんたん静的サイト生成…するための準備</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/12/24 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  



      <a class="mb-2" href="/2013/12/24/ruby-qr/">RubyでQRコードを生成してみる</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/09/07 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/git' class="muted-link">
      [<span class="Label Label--gray">Git</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/jekyll' class="muted-link">
      [<span class="Label Label--gray">Jekyll</span>]
    </a>
  



      <a class="mb-2" href="/2013/09/07/jekyll-maintenance-2/">Jekyllバージョンアップの際に思いのほか手こずった話 てっく煮さん製プラグインの更新に追従したい編</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/09/03 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/rails' class="muted-link">
      [<span class="Label Label--gray">Rails</span>]
    </a>
  



      <a class="mb-2" href="/2013/09/03/redmine-content-length-error/">Ruby1.9.3のWebrickで出るCould not determine content-length...エラーを消す方法(2.0.0では解決済)</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/08/26 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  



      <a class="mb-2" href="/2013/08/26/utf8-space-c2a0/">ソースコード中に0xC2A0(UTF-8のNO-BREAK SPACE)が混ざり実行できなくて困った話</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/08/20 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/rails' class="muted-link">
      [<span class="Label Label--gray">Rails</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/redmine' class="muted-link">
      [<span class="Label Label--gray">Redmine</span>]
    </a>
  



      <a class="mb-2" href="/2013/08/20/rails3-log-not-colorize/">Rails3のログ出力にANSIカラーコードを使用しない設定</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/08/07 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/jekyll' class="muted-link">
      [<span class="Label Label--gray">Jekyll</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/git' class="muted-link">
      [<span class="Label Label--gray">Git</span>]
    </a>
  



      <a class="mb-2" href="/2013/08/07/jekyll-maintenance-1/">Jekyllバージョンアップの際に思いのほか手こずった話 Jekyll Bootstrapの更新に追従したい編</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/05/27 </span>
      


  
    <a href='https://note.gosyujin.com/tags/jekyll' class="muted-link">
      [<span class="Label Label--gray">Jekyll</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  



      <a class="mb-2" href="/2013/05/27/jekyll-githubpages-analytics-setting/">Jekyll@GitHub Pagesの運用形態を変えたのでAnalyticsの設定が効かなくなっていた</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/05/23 </span>
      


  
    <a href='https://note.gosyujin.com/tags/jekyll' class="muted-link">
      [<span class="Label Label--gray">Jekyll</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/liquid' class="muted-link">
      [<span class="Label Label--gray">Liquid</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  



      <a class="mb-2" href="/2013/05/23/jekyll-liquid-plugin2/">記事の目次を出力するJekyllプラグインの改良</a>
    </li>
  
    
      <li class="newer-post">
    
      <span>2013/04/11 </span>
      


  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/jekyll' class="muted-link">
      [<span class="Label Label--gray">Jekyll</span>]
    </a>
  



      <a class="mb-2" href="/2013/04/11/jekyll-0120/">Jekyllのバージョンを 0.12.0 にあげた</a>
    </li>
  
    
      <li class="older-post">
    
      <span>2013/03/18 </span>
      


  
    <a href='https://note.gosyujin.com/tags/selenium' class="muted-link">
      [<span class="Label Label--gray">Selenium</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/firefox' class="muted-link">
      [<span class="Label Label--gray">Firefox</span>]
    </a>
  
    <a href='https://note.gosyujin.com/tags/ruby' class="muted-link">
      [<span class="Label Label--gray">Ruby</span>]
    </a>
  



      <a class="mb-2" href="/2013/03/18/selenium-firefox-loaderror/">Selenium WebDriverでFirefoxがロードできなくなった</a>
    </li>
  
</ol>


    </div>

  

      </div>

      <div id="side" class="bg-white">
        <div>
          
  <div id="profile" class="Box Box-blue p-2 mb-3 mt-5">
  <h3>Link</h3>
  <ul>
    <li>
      <a href="https://github.com/gosyujin">GitHub</a>
    </li>
    <li>
      <a href="http://www.slideshare.net/kk_Ataka">Slideshare</a>
    </li>
    <li>
      <a href="http://connpass.com/user/kk_Ataka/">Connpass</a>
    </li>
 </ul>
</div>





  <div id="recent" class="Box Box-blue p-2 mb-3 mt-5">
    <a href="https://note.gosyujin.com"><h3>Recent Entry</h3></a>
    <ul>
      
        <li>
          <span>19/7/9 </span>
          
          <a class="mb-2" href="/2019/07/09/android-studio-code-format/">Android Studioのコードフォーマットをプロジェクトで統一する</a>
        </li>
      
        <li>
          <span>19/7/2 </span>
          
          <a class="mb-2" href="/2019/07/02/jsp-js-mix/">JSPのスクリプトレットとjavascriptで同じ変数を使ってハマった話</a>
        </li>
      
        <li>
          <span>19/6/20 </span>
          
          <a class="mb-2" href="/2019/06/20/stty-ixon/">Ctrl&#43;Sで画面停止する機能を無効化する</a>
        </li>
      
        <li>
          <span>19/6/13 </span>
          
          <a class="mb-2" href="/2019/06/13/sqlserver-varchar-nvarchar/">SQL Serverでnvarchar(x)のカラムにx文字入らないのはなぜ</a>
        </li>
      
        <li>
          <span>19/6/3 </span>
          
          <a class="mb-2" href="/2019/06/03/sqlserver-show-columns-logical-name/">SQL Serverのカラムに設定されている論理名をまとめて取得する</a>
        </li>
      
        <li>
          <span>19/5/21 </span>
          
          <a class="mb-2" href="/2019/05/21/sqlserver-query-parameter/">SQL Serverの動的管理ビューから、実行したSQL(とバインド変数)を取得する</a>
        </li>
      
        <li>
          <span>19/5/2 </span>
          
          <a class="mb-2" href="/2019/05/02/sqlserver-convert-implicit/">SQL Serverで実行したSQLが暗黙の型変換が起こっているかどうかはどうやって調べたらよいのか</a>
        </li>
      
        <li>
          <span>19/4/23 </span>
          
          <a class="mb-2" href="/2019/04/23/database-alter-table/">色々なDBのバージョン確認方法とか論理名のつけ方とか</a>
        </li>
      
        <li>
          <span>19/4/15 </span>
          
          <a class="mb-2" href="/2019/04/15/sqlserver-collation-name/">SQL Serverでの照合順序の確認方法</a>
        </li>
      
        <li>
          <span>17/6/30 </span>
          
          <a class="mb-2" href="/2017/06/30/nicorepo/">ニコレポの仕様が変わったので一覧情報の取得方法を調査した</a>
        </li>
      
    </ul>
  </div>



  <div id="tags" class="Box Box--blue p-2 mb-3 mt-5">
    <a href="/tags/"><h3>Tags</h3></a>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/a5-sql-mk-2" class="link-gray text-emphasized css-truncate-target">
          <span class="">A5 SQL Mk-2</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/api" class="link-gray text-emphasized css-truncate-target">
          <span class="">API</span>
        </a>
        <span class="text-right Counter">8</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/agile" class="link-gray text-emphasized css-truncate-target">
          <span class="">Agile</span>
        </a>
        <span class="text-right Counter">2</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/android" class="link-gray text-emphasized css-truncate-target">
          <span class="">Android</span>
        </a>
        <span class="text-right Counter">8</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/ansible" class="link-gray text-emphasized css-truncate-target">
          <span class="">Ansible</span>
        </a>
        <span class="text-right Counter">2</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/application" class="link-gray text-emphasized css-truncate-target">
          <span class="">Application</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/bundle" class="link-gray text-emphasized css-truncate-target">
          <span class="">Bundle</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/chef" class="link-gray text-emphasized css-truncate-target">
          <span class="">Chef</span>
        </a>
        <span class="text-right Counter">2</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/db2" class="link-gray text-emphasized css-truncate-target">
          <span class="">DB2</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/dropbox" class="link-gray text-emphasized css-truncate-target">
          <span class="">Dropbox</span>
        </a>
        <span class="text-right Counter">3</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/eclipse" class="link-gray text-emphasized css-truncate-target">
          <span class="">Eclipse</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/evernote" class="link-gray text-emphasized css-truncate-target">
          <span class="">Evernote</span>
        </a>
        <span class="text-right Counter">2</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/firefox" class="link-gray text-emphasized css-truncate-target">
          <span class="">Firefox</span>
        </a>
        <span class="text-right Counter">2</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/fluentd" class="link-gray text-emphasized css-truncate-target">
          <span class="">Fluentd</span>
        </a>
        <span class="text-right Counter">3</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/git" class="link-gray text-emphasized css-truncate-target">
          <span class="">Git</span>
        </a>
        <span class="text-right Counter">16</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/github" class="link-gray text-emphasized css-truncate-target">
          <span class="">GitHub</span>
        </a>
        <span class="text-right Counter">2</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/gmail" class="link-gray text-emphasized css-truncate-target">
          <span class="">Gmail</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/golang" class="link-gray text-emphasized css-truncate-target">
          <span class="">Golang</span>
        </a>
        <span class="text-right Counter">4</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/gradle" class="link-gray text-emphasized css-truncate-target">
          <span class="">Gradle</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/haml" class="link-gray text-emphasized css-truncate-target">
          <span class="">Haml</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/haskell" class="link-gray text-emphasized css-truncate-target">
          <span class="">Haskell</span>
        </a>
        <span class="text-right Counter">5</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/heroku" class="link-gray text-emphasized css-truncate-target">
          <span class="">Heroku</span>
        </a>
        <span class="text-right Counter">5</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/homebrew" class="link-gray text-emphasized css-truncate-target">
          <span class="">Homebrew</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/hubot" class="link-gray text-emphasized css-truncate-target">
          <span class="">Hubot</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/hugo" class="link-gray text-emphasized css-truncate-target">
          <span class="">Hugo</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/ie" class="link-gray text-emphasized css-truncate-target">
          <span class="">IE</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/jsp" class="link-gray text-emphasized css-truncate-target">
          <span class="">JSP</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/java" class="link-gray text-emphasized css-truncate-target">
          <span class="">Java</span>
        </a>
        <span class="text-right Counter">11</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/javascript" class="link-gray text-emphasized css-truncate-target">
          <span class="">JavaScript</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/jekyll" class="link-gray text-emphasized css-truncate-target">
          <span class="">Jekyll</span>
        </a>
        <span class="text-right Counter">20</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/jenkins" class="link-gray text-emphasized css-truncate-target">
          <span class="">Jenkins</span>
        </a>
        <span class="text-right Counter">7</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/liquid" class="link-gray text-emphasized css-truncate-target">
          <span class="">Liquid</span>
        </a>
        <span class="text-right Counter">3</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/lokka" class="link-gray text-emphasized css-truncate-target">
          <span class="">Lokka</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/mac" class="link-gray text-emphasized css-truncate-target">
          <span class="">Mac</span>
        </a>
        <span class="text-right Counter">8</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/markdown" class="link-gray text-emphasized css-truncate-target">
          <span class="">Markdown</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/mysql" class="link-gray text-emphasized css-truncate-target">
          <span class="">MySql</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/oauth" class="link-gray text-emphasized css-truncate-target">
          <span class="">OAuth</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/oracle" class="link-gray text-emphasized css-truncate-target">
          <span class="">Oracle</span>
        </a>
        <span class="text-right Counter">6</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/postgresql" class="link-gray text-emphasized css-truncate-target">
          <span class="">PostgreSQL</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/python" class="link-gray text-emphasized css-truncate-target">
          <span class="">Python</span>
        </a>
        <span class="text-right Counter">6</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/rspec" class="link-gray text-emphasized css-truncate-target">
          <span class="">RSpec</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/rails" class="link-gray text-emphasized css-truncate-target">
          <span class="">Rails</span>
        </a>
        <span class="text-right Counter">4</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/redmine" class="link-gray text-emphasized css-truncate-target">
          <span class="">Redmine</span>
        </a>
        <span class="text-right Counter">9</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/ruby" class="link-gray text-emphasized css-truncate-target">
          <span class="">Ruby</span>
        </a>
        <span class="text-right Counter">75</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/sql" class="link-gray text-emphasized css-truncate-target">
          <span class="">SQL</span>
        </a>
        <span class="text-right Counter">3</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/sql-server" class="link-gray text-emphasized css-truncate-target">
          <span class="">SQL Server</span>
        </a>
        <span class="text-right Counter">6</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/sqlite3" class="link-gray text-emphasized css-truncate-target">
          <span class="">SQLite3</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/scala" class="link-gray text-emphasized css-truncate-target">
          <span class="">Scala</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/selenium" class="link-gray text-emphasized css-truncate-target">
          <span class="">Selenium</span>
        </a>
        <span class="text-right Counter">2</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/shell" class="link-gray text-emphasized css-truncate-target">
          <span class="">Shell</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/sinatra" class="link-gray text-emphasized css-truncate-target">
          <span class="">Sinatra</span>
        </a>
        <span class="text-right Counter">2</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/slideshare" class="link-gray text-emphasized css-truncate-target">
          <span class="">SlideShare</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/solaris" class="link-gray text-emphasized css-truncate-target">
          <span class="">Solaris</span>
        </a>
        <span class="text-right Counter">12</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/sphinx" class="link-gray text-emphasized css-truncate-target">
          <span class="">Sphinx</span>
        </a>
        <span class="text-right Counter">18</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/startup" class="link-gray text-emphasized css-truncate-target">
          <span class="">StartUp</span>
        </a>
        <span class="text-right Counter">6</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/subversion" class="link-gray text-emphasized css-truncate-target">
          <span class="">Subversion</span>
        </a>
        <span class="text-right Counter">9</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/tdd" class="link-gray text-emphasized css-truncate-target">
          <span class="">TDD</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/test" class="link-gray text-emphasized css-truncate-target">
          <span class="">Test</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/translate" class="link-gray text-emphasized css-truncate-target">
          <span class="">Translate</span>
        </a>
        <span class="text-right Counter">2</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/twitter" class="link-gray text-emphasized css-truncate-target">
          <span class="">Twitter</span>
        </a>
        <span class="text-right Counter">4</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/unix" class="link-gray text-emphasized css-truncate-target">
          <span class="">Unix</span>
        </a>
        <span class="text-right Counter">14</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/vb" class="link-gray text-emphasized css-truncate-target">
          <span class="">VB</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/vim" class="link-gray text-emphasized css-truncate-target">
          <span class="">Vim</span>
        </a>
        <span class="text-right Counter">3</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/wicket" class="link-gray text-emphasized css-truncate-target">
          <span class="">Wicket</span>
        </a>
        <span class="text-right Counter">6</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/wiki" class="link-gray text-emphasized css-truncate-target">
          <span class="">Wiki</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/windows" class="link-gray text-emphasized css-truncate-target">
          <span class="">Windows</span>
        </a>
        <span class="text-right Counter">25</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/ios" class="link-gray text-emphasized css-truncate-target">
          <span class="">iOS</span>
        </a>
        <span class="text-right Counter">3</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/iphone" class="link-gray text-emphasized css-truncate-target">
          <span class="">iPhone</span>
        </a>
        <span class="text-right Counter">4</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/java-ja" class="link-gray text-emphasized css-truncate-target">
          <span class="">java-ja</span>
        </a>
        <span class="text-right Counter">4</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/node.js" class="link-gray text-emphasized css-truncate-target">
          <span class="">node.js</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/rest" class="link-gray text-emphasized css-truncate-target">
          <span class="">reST</span>
        </a>
        <span class="text-right Counter">3</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/xquery" class="link-gray text-emphasized css-truncate-target">
          <span class="">xQuery</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/%e3%81%95%e3%81%8f%e3%82%89vps" class="link-gray text-emphasized css-truncate-target">
          <span class="">さくらVPS</span>
        </a>
        <span class="text-right Counter">3</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/%e3%82%a4%e3%83%99%e3%83%b3%e3%83%88" class="link-gray text-emphasized css-truncate-target">
          <span class="">イベント</span>
        </a>
        <span class="text-right Counter">27</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/%e3%83%8d%e3%82%bf" class="link-gray text-emphasized css-truncate-target">
          <span class="">ネタ</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/%e6%96%87%e5%ad%97%e3%82%b3%e3%83%bc%e3%83%89" class="link-gray text-emphasized css-truncate-target">
          <span class="">文字コード</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/%e6%97%a5%e8%a8%98" class="link-gray text-emphasized css-truncate-target">
          <span class="">日記</span>
        </a>
        <span class="text-right Counter">11</span>
      </span>
    
      <span class="css-truncate no-wrap m-1 pl-1">
        <a href="/tags/%e8%aa%bf%e6%9f%bb%e3%83%ad%e3%82%b0" class="link-gray text-emphasized css-truncate-target">
          <span class="">調査ログ</span>
        </a>
        <span class="text-right Counter">1</span>
      </span>
    
  </div>




        </div>
        <aside>
          
  
  
  <div id="toc" class="Box Box--blue p-2 mb-3 mt-5">
    <h3>目次</h3>
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#あらすじ">あらすじ</a></li>
<li><a href="#環境-windows編">環境(Windows編)</a></li>
<li><a href="#手順">手順</a>
<ul>
<li><a href="#chef-インストール">Chef インストール</a></li>
<li><a href="#構成-レポジトリ-クックブック-レシピ">構成 レポジトリ、クックブック、レシピ</a>
<ul>
<li><a href="#レポジトリ作成-コピー">レポジトリ作成(コピー)</a></li>
<li><a href="#クックブック作成">クックブック作成</a></li>
<li><a href="#レシピ編集">レシピ編集</a></li>
</ul></li>
<li><a href="#その他設定色々-動かすためにもう少し">その他設定色々、動かすためにもう少し</a></li>
<li><a href="#実行">実行</a></li>
</ul></li>
<li><a href="#本当に何かインストールしてみる">本当に何かインストールしてみる</a></li>
<li><a href="#環境-linux編">環境(Linux編)</a></li>
<li><a href="#インストールテスト-zsh">インストールテスト(zsh)</a></li>
<li><a href="#インストールテスト-nginx">インストールテスト(nginx)</a>
<ul>
<li><a href="#service">service</a></li>
<li><a href="#template">template</a></li>
<li><a href="#cookbook-file">cookbook file</a></li>
<li><a href="#directory">directory</a></li>
<li><a href="#user">user</a></li>
<li><a href="#group">group</a></li>
<li><a href="#bash">bash</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>





        </aside>
      </div>

      <div id="footer" class="pt-2 pb-3 bg-white text-center">
        <span class="text-small text-gray">
  Powered by
  <a href="https://gohugo.io" class="link-gray-dark">Hugo</a>
  
  
  0.40.1 2018-04-25T17:16:11Z theme based on
  <a href="https://github.com/qqhann/hugo-primer" class="link-gray-dark">Hugo-Primer</a>
  &#x00A9; 2009-2019 <a href="https://gosyujin.com" class="link-gray-dark">kk_Ataka</a>
</span>

      </div>
    </div>

    
    
    
    
  </body>
</html>
